<%- include('partials/header') %>

<div class="container mt-4">
    <h1>Katha Dashboard</h1>
    <p>Overview of Katha videos.</p>

    <% if (exportUrl) { %>
        <a href="<%= exportUrl %>" class="btn btn-success mb-3">Export Katha Dashboard Data</a>
    <% } %>

    <% if (videos && videos.length > 0) { %>
        <table class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>DB ID</th>
                    <th>Video ID</th>
                    <th>Title</th>
                    <th>Channel ID</th>
                    <th>Type</th>
                    <th>Category</th>
                    <th>Playlist Name</th>
                    <th>Orator</th>
                    <th>Sabha No.</th>
                    <th>Granth Name</th>
                </tr>
            </thead>
            <tbody>
                <% videos.forEach(video => { %>
                    <tr>
                        <td><%= video.video_db_id %></td>
                        <td><a href="https://www.youtube.com/watch?v=<%= video.video_id %>" target="_blank"><%= video.video_id %></a></td>
                        <td><%= video.video_title %></td>
                        <td><%= video.channel_id %></td>
                        <td><%= video.type_name %></td>
                        <td><%= video.category_name %></td>
                        <td><%= video.playlist_name || 'N/A' %></td>
                        <td><%= video.orator || 'N/A' %></td>
                        <td><%= video.sabha_number || 'N/A' %></td>
                        <td><%= video.granth_name || 'N/A' %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>

        <!-- Pagination -->
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <% if (currentPage > 1) { %>
                    <li class="page-item"><a class="page-link" href="?page=<%= currentPage - 1 %>">Previous</a></li>
                <% } %>
                <% for (let i = 1; i <= totalPages; i++) { %>
                    <li class="page-item <%= i === currentPage ? 'active' : '' %>"><a class="page-link" href="?page=<%= i %>"><%= i %></a></li>
                <% } %>
                <% if (currentPage < totalPages) { %>
                    <li class="page-item"><a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a></li>
                <% } %>
            </ul>
        </nav>

    <% } else { %>
        <p>No Katha videos found in the dashboard. Please upload data.</p>
    <% } %>
</div>

<%- include('partials/footer') %>